/*
Deployment script for CarOfferCodeChallange

This code was generated by a tool.
Changes to this file may cause incorrect behavior and will be lost if
the code is regenerated.
*/

GO
SET ANSI_NULLS, ANSI_PADDING, ANSI_WARNINGS, ARITHABORT, CONCAT_NULL_YIELDS_NULL, QUOTED_IDENTIFIER ON;

SET NUMERIC_ROUNDABORT OFF;


GO
:setvar DatabaseName "CarOfferCodeChallange"
:setvar DefaultFilePrefix "CarOfferCodeChallange"
:setvar DefaultDataPath "C:\Users\xeavi\AppData\Local\Microsoft\Microsoft SQL Server Local DB\Instances\MSSQLLocalDB\"
:setvar DefaultLogPath "C:\Users\xeavi\AppData\Local\Microsoft\Microsoft SQL Server Local DB\Instances\MSSQLLocalDB\"

GO
:on error exit
GO
/*
Detect SQLCMD mode and disable script execution if SQLCMD mode is not supported.
To re-enable the script after enabling SQLCMD mode, execute the following:
SET NOEXEC OFF; 
*/
:setvar __IsSqlCmdEnabled "True"
GO
IF N'$(__IsSqlCmdEnabled)' NOT LIKE N'True'
    BEGIN
        PRINT N'SQLCMD mode must be enabled to successfully execute this script.';
        SET NOEXEC ON;
    END


GO
USE [$(DatabaseName)];


GO
IF EXISTS (SELECT 1
           FROM   [master].[dbo].[sysdatabases]
           WHERE  [name] = N'$(DatabaseName)')
    BEGIN
        ALTER DATABASE [$(DatabaseName)]
            SET ANSI_NULLS ON,
                ANSI_PADDING ON,
                ANSI_WARNINGS ON,
                ARITHABORT ON,
                CONCAT_NULL_YIELDS_NULL ON,
                QUOTED_IDENTIFIER ON,
                ANSI_NULL_DEFAULT ON,
                CURSOR_DEFAULT LOCAL 
            WITH ROLLBACK IMMEDIATE;
    END


GO
IF EXISTS (SELECT 1
           FROM   [master].[dbo].[sysdatabases]
           WHERE  [name] = N'$(DatabaseName)')
    BEGIN
        ALTER DATABASE [$(DatabaseName)]
            SET PAGE_VERIFY NONE 
            WITH ROLLBACK IMMEDIATE;
    END


GO
ALTER DATABASE [$(DatabaseName)]
    SET TARGET_RECOVERY_TIME = 0 SECONDS 
    WITH ROLLBACK IMMEDIATE;


GO
IF EXISTS (SELECT 1
           FROM   [master].[dbo].[sysdatabases]
           WHERE  [name] = N'$(DatabaseName)')
    BEGIN
        ALTER DATABASE [$(DatabaseName)]
            SET QUERY_STORE (CLEANUP_POLICY = (STALE_QUERY_THRESHOLD_DAYS = 367)) 
            WITH ROLLBACK IMMEDIATE;
    END


GO
/*
Post-Deployment Script Template							
--------------------------------------------------------------------------------------
 This file contains SQL statements that will be appended to the build script.		
 Use SQLCMD syntax to include a file in the post-deployment script.			
 Example:      :r .\myfile.sql								
 Use SQLCMD syntax to reference a variable in the post-deployment script.		
 Example:      :setvar TableName MyTable							
               SELECT * FROM [$(TableName)]					
--------------------------------------------------------------------------------------
*/
SET NOCOUNT ON;

SET IDENTITY_INSERT HondaWMI ON

MERGE INTO HondaWMI AS TARGET


USING (
	VALUES
	(987,'HONDA MOTOR CO., LTD','Passenger Car','JHM',NULL,TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-03-26', 'YYYY-MM-DD'),TODATE('2015-06-04', 'YYYY-MM-DD')),
	(988,'HONDA OF AMERICA MFG., INC.','Passenger Car','1HG','UNITED STATES (USA)',TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-03-26', 'YYYY-MM-DD'),NULL),
	(989,'HONDA MFG., ALABAMA., LLC.','Passenger Car','5KB','UNITED STATES (USA)',TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-03-26', 'YYYY-MM-DD'),NULL),
	(990,'HONDA OF CANADA MFG., INC.','Passenger Car','2HG','CANADA',TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-03-26', 'YYYY-MM-DD'),NULL),
	(991,'HONDA OF THE U.K. MFG., LTD.','Passenger Car','SHH','UNITED KINGDOM (UK)',TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-03-26', 'YYYY-MM-DD'),NULL),
	(992,'HONDA DE MEXICO','Passenger Car','3HG','MEXICO',TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-03-26', 'YYYY-MM-DD'),NULL),
	(993,'HONDA MFG., INDIANA., LLC.','Passenger Car','19X',NULL,TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-03-26', 'YYYY-MM-DD'),NULL),
	(987,'HONDA MOTOR CO., LTD','Passenger Car','JH4',NULL,TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-03-27', 'YYYY-MM-DD'),NULL),
	(987,'HONDA MOTOR CO., LTD','Multipurpose Passenger Vehicle (MPV)','JHL',NULL,TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-03-27', 'YYYY-MM-DD'),NULL),
	(987,'HONDA MOTOR CO., LTD','Truck ','JH1',NULL,TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-03-27', 'YYYY-MM-DD'),NULL),
	(988,'HONDA OF AMERICA MFG., INC.','Passenger Car','19U','UNITED STATES (USA)',TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-03-27', 'YYYY-MM-DD'),TODATE('2015-03-27', 'YYYY-MM-DD')),
	(988,'HONDA OF AMERICA MFG., INC.','Multipurpose Passenger Vehicle (MPV)','5J6','UNITED STATES (USA)',TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-03-27', 'YYYY-MM-DD'),NULL),
	(988,'HONDA OF AMERICA MFG., INC.','Multipurpose Passenger Vehicle (MPV)','5J8','UNITED STATES (USA)',TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-03-27', 'YYYY-MM-DD'),TODATE('2015-03-27', 'YYYY-MM-DD')),
	(988,'HONDA OF AMERICA MFG., INC.','Truck ','5J7','UNITED STATES (USA)',TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-03-27', 'YYYY-MM-DD'),NULL),
	(988,'HONDA OF AMERICA MFG., INC.','Truck ','5J0','UNITED STATES (USA)',TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-03-27', 'YYYY-MM-DD'),NULL),
	(989,'HONDA MFG., ALABAMA., LLC.','Passenger Car','5KC','UNITED STATES (USA)',TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-03-27', 'YYYY-MM-DD'),NULL),
	(989,'HONDA MFG., ALABAMA., LLC.','Multipurpose Passenger Vehicle (MPV)','5FN','UNITED STATES (USA)',TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-03-27', 'YYYY-MM-DD'),NULL),
	(989,'HONDA MFG., ALABAMA., LLC.','Multipurpose Passenger Vehicle (MPV)','5FR','UNITED STATES (USA)',TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-03-27', 'YYYY-MM-DD'),NULL),
	(989,'HONDA MFG., ALABAMA., LLC.','Truck ','5FP','UNITED STATES (USA)',TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-03-27', 'YYYY-MM-DD'),NULL),
	(989,'HONDA MFG., ALABAMA., LLC.','Truck ','5FS','UNITED STATES (USA)',TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-03-27', 'YYYY-MM-DD'),NULL),
	(990,'HONDA OF CANADA MFG., INC.','Passenger Car','2HH','CANADA',TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-03-27', 'YYYY-MM-DD'),TODATE('2015-03-27', 'YYYY-MM-DD')),
	(990,'HONDA OF CANADA MFG., INC.','Multipurpose Passenger Vehicle (MPV)','2HK','CANADA',TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-03-27', 'YYYY-MM-DD'),NULL),
	(990,'HONDA OF CANADA MFG., INC.','Multipurpose Passenger Vehicle (MPV)','2HN','CANADA',TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-03-27', 'YYYY-MM-DD'),NULL),
	(990,'HONDA OF CANADA MFG., INC.','Truck ','2HJ','CANADA',TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-03-27', 'YYYY-MM-DD'),NULL),
	(990,'HONDA OF CANADA MFG., INC.','Truck ','2HU','CANADA',TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-03-27', 'YYYY-MM-DD'),NULL),
	(991,'HONDA OF THE U.K. MFG., LTD.','Multipurpose Passenger Vehicle (MPV)','SHS','UNITED KINGDOM (UK)',TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-03-27', 'YYYY-MM-DD'),NULL),
	(992,'HONDA DE MEXICO','Multipurpose Passenger Vehicle (MPV)','3CZ','MEXICO',TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-03-27', 'YYYY-MM-DD'),NULL),
	(1154,'AMERICAN HONDA MOTOR CO., INC.','Motorcycle','JH2',NULL,TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-04-03', 'YYYY-MM-DD'),TODATE('2015-06-04', 'YYYY-MM-DD')),
	(1154,'AMERICAN HONDA MOTOR CO., INC.','Motorcycle','1HF',NULL,TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-04-03', 'YYYY-MM-DD'),TODATE('2015-06-04', 'YYYY-MM-DD')),
	(988,'HONDA OF AMERICA MFG., INC.','Motorcycle','YC1','BELGIUM',TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-04-03', 'YYYY-MM-DD'),TODATE('2016-07-08', 'YYYY-MM-DD')),
	(1154,'AMERICAN HONDA MOTOR CO., INC.','Motorcycle','3H1',NULL,TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-04-03', 'YYYY-MM-DD'),TODATE('2015-06-04', 'YYYY-MM-DD')),
	(993,'HONDA MFG., INDIANA., LLC.','Passenger Car','19V','UNITED STATES (USA)',TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-04-21', 'YYYY-MM-DD'),NULL),
	(1154,'AMERICAN HONDA MOTOR CO., INC.','Motorcycle','ZDC',NULL,TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-06-04', 'YYYY-MM-DD'),TODATE('2016-06-17', 'YYYY-MM-DD')),
	(1154,'AMERICAN HONDA MOTOR CO., INC.','Motorcycle','MLH',NULL,TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-06-04', 'YYYY-MM-DD'),NULL),
	(14790,'SUNDIRO HONDA MOTORCYCLE CO., LTD.','Motorcycle','LAL','CHINA',TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-06-04', 'YYYY-MM-DD'),TODATE('2017-08-01', 'YYYY-MM-DD')),
	(1154,'AMERICAN HONDA MOTOR CO., INC.','Motorcycle','RLH',NULL,TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-06-04', 'YYYY-MM-DD'),NULL),
	(1154,'AMERICAN HONDA MOTOR CO., INC.','Motorcycle','VTM',NULL,TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-06-04', 'YYYY-MM-DD'),NULL),
	(1154,'AMERICAN HONDA MOTOR CO., INC.','Motorcycle','LWB',NULL,TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-06-04', 'YYYY-MM-DD'),NULL),
	(12142,'CHONGQING GUANGYU MOTORCYCLE MANUFACTURE CO., LTD.','Motorcycle','LRY','CHINA',TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-07-07', 'YYYY-MM-DD'),TODATE('2019-11-06', 'YYYY-MM-DD')),
	(11163,'CHONGQING HI-BIRD MOTORCYCLE INDUSTRY CO., LTD.','Motorcycle','LSR','CHINA',TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-07-07', 'YYYY-MM-DD'),NULL),
	(12294,'CHONGQING KAIER MOTORCYCLE MANUFACTURING CO.,','Motorcycle','LYE','CHINA',TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-07-07', 'YYYY-MM-DD'),NULL),
	(10479,'CHONGQING KINLON MOTORCYCLE MANUFACTURE CO., LTD','Motorcycle','LLC','CHINA',TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-07-07', 'YYYY-MM-DD'),TODATE('2015-07-22', 'YYYY-MM-DD')),
	(11366,'CHONGQING HUANSONG INDUSTRIES (GROUP) CO., LTD.','Motorcycle','LWG','CHINA',TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-07-07', 'YYYY-MM-DD'),NULL),
	(1471,'CHONGQING RATO POWER CO., LTD.','Motorcycle','LRP','CHINA',TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-07-07', 'YYYY-MM-DD'),NULL),
	(6877,'CHONGQING YINXIANG MOTORCYCLE (GROUP) CO., LTD.','Motorcycle','LB4','CHINA',TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-07-07', 'YYYY-MM-DD'),TODATE('2015-09-15', 'YYYY-MM-DD')),
	(1154,'AMERICAN HONDA MOTOR CO., INC.','Multipurpose Passenger Vehicle (MPV)','JR2','UNITED STATES (USA)',TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-07-15', 'YYYY-MM-DD'),NULL),
	(10754,'WUXI JINHONG MOTORCYCLE CO., LTD','Motorcycle','LC3','CHINA',TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-07-16', 'YYYY-MM-DD'),TODATE('2017-08-22', 'YYYY-MM-DD')),
	(6460,'JOYHON, INC.','Trailer','1J9390','UNITED STATES (USA)',TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-07-20', 'YYYY-MM-DD'),NULL),
	(6108,'CHANGZHOU ZHONGMAO MACHINERY CO., LTD','Trailer','L0H','CHINA',TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-07-20', 'YYYY-MM-DD'),NULL),
	(12293,'CHONGQING ASTRONAUTIC BASHAN MOTORCYCLE MANUFACTURING CO., LTD.','Motorcycle','LHJ','CHINA',TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-07-21', 'YYYY-MM-DD'),NULL),
	(11400,'MARATHON METALWORKS','Trailer','1M9822','UNITED STATES (USA)',TODATE('2015-01-01', 'YYYY-MM-DD'),TODATE('2015-07-23', 'YYYY-MM-DD'),NULL),
	(11152,'CHONGQING HENSIM GROUP CO., LTD.','Motorcycle','LUA','CHINA',TODATE('2015-07-27', 'YYYY-MM-DD'),TODATE('2015-07-27', 'YYYY-MM-DD'),NULL),
	(13493,'JIANGMEN SINO-HONGKONG BAOTIAN MOTORCYCLE INDUSTRIAL CO., LTD.','Motorcycle','L82','CHINA',TODATE('2015-08-05', 'YYYY-MM-DD'),TODATE('2015-08-05', 'YYYY-MM-DD'),NULL),
	(7575,'SHANDONG ZHONGTONG FEIYAN AUTOMOBILE CO. LTD.','Motorcycle','L69FYK','UNITED STATES (USA)',TODATE('2015-08-07', 'YYYY-MM-DD'),TODATE('2015-08-07', 'YYYY-MM-DD'),NULL),
	(9274,'TAIZHOU ZHONGNENG MOTORCYCLE CO., LTD.','Motorcycle','L5Y','CHINA',TODATE('2015-08-10', 'YYYY-MM-DD'),TODATE('2015-08-10', 'YYYY-MM-DD'),NULL),
	(1327,'SHANGHAI HUIZHONG AUTOMOTIVE MANUFACTURING CO., LTD','Trailer','LSB','CHINA',TODATE('2015-08-11', 'YYYY-MM-DD'),TODATE('2015-08-11', 'YYYY-MM-DD'),NULL),
	(8915,'SHANGHAI HONLING MOTORCYCLE MANUFACTURE CO., LTD.','Motorcycle','LLA','CHINA',TODATE('2015-08-11', 'YYYY-MM-DD'),TODATE('2015-08-11', 'YYYY-MM-DD'),NULL),
	(18814,'CHONGQING ANDES MOTORCYCLE MANUFACTURING CO.,LTD.','Motorcycle','LKX','CHINA',TODATE('2015-08-31', 'YYYY-MM-DD'),TODATE('2015-08-31', 'YYYY-MM-DD'),TODATE('2020-05-01', 'YYYY-MM-DD')),
	(10038,'CHONGQING SHUANGQING MECHANICAL & ELECTRICAL CO.','Motorcycle','LZX','CHINA',TODATE('2015-09-03', 'YYYY-MM-DD'),TODATE('2015-09-03', 'YYYY-MM-DD'),TODATE('2016-06-24', 'YYYY-MM-DD')),
	(9554,'CHONGQUING DAJIANG MOTORCYCLES CO., LTD','Motorcycle','L1P','CHINA',TODATE('2015-09-04', 'YYYY-MM-DD'),TODATE('2015-09-04', 'YYYY-MM-DD'),TODATE('2019-11-07', 'YYYY-MM-DD')),
	(1695,'MARATHON HOMES CORPORATION','Trailer','1M9019','UNITED STATES (USA)',TODATE('2015-09-16', 'YYYY-MM-DD'),TODATE('2015-09-16', 'YYYY-MM-DD'),NULL),
	(7363,'Xinri E-Vehicle Hongkong Co., Limited','Motorcycle','R12','CHINA',TODATE('2015-11-06', 'YYYY-MM-DD'),TODATE('2015-11-06', 'YYYY-MM-DD'),NULL),
	(14236,'CHONGQING SHINERAY MOTORCYCLE CO., LTD.','Motorcycle','LXY','CHINA',TODATE('2015-12-17', 'YYYY-MM-DD'),TODATE('2015-12-17', 'YYYY-MM-DD'),TODATE('2018-08-06', 'YYYY-MM-DD')),
	(1154,'AMERICAN HONDA MOTOR CO., INC.','Motorcycle','9C2',NULL,TODATE('1988-12-30', 'YYYY-MM-DD'),TODATE('2015-12-30', 'YYYY-MM-DD'),NULL),
	(987,'HONDA MOTOR CO., LTD','Motorcycle','JH3','JAPAN',TODATE('2016-06-08', 'YYYY-MM-DD'),TODATE('2016-06-08', 'YYYY-MM-DD'),NULL),
	(993,'HONDA MFG., INDIANA., LLC.','Motorcycle','478','UNITED STATES (USA)',TODATE('2016-06-08', 'YYYY-MM-DD'),TODATE('2016-06-08', 'YYYY-MM-DD'),NULL),
	(15171,'MONTESA HONDA SA','Motorcycle','VTD','SPAIN',TODATE('2016-06-17', 'YYYY-MM-DD'),TODATE('2016-06-17', 'YYYY-MM-DD'),NULL),
	(15538,'CHONGQING YINGANG SCIENCE & TECHNOLOGY (GROUP) CO., LTD.','Motorcycle','LY4','CHINA',TODATE('2016-08-31', 'YYYY-MM-DD'),TODATE('2016-08-31', 'YYYY-MM-DD'),TODATE('2016-09-01', 'YYYY-MM-DD')),
	(15739,'RONGCHENG COMPAKS (HONG KONG) NEW ENERGY AUTOMOBILE CO LTD','Trailer','R1V','HONG KONG',TODATE('2016-10-26', 'YYYY-MM-DD'),TODATE('2016-10-26', 'YYYY-MM-DD'),NULL),
	(15238,'MARATHON EQUIPMENT LTD ','Trailer','2M9004','CANADA',TODATE('2017-02-22', 'YYYY-MM-DD'),TODATE('2017-02-22', 'YYYY-MM-DD'),TODATE('2017-04-11', 'YYYY-MM-DD')),
	(993,'HONDA MFG., INDIANA., LLC.','Multipurpose Passenger Vehicle (MPV)','7FA','UNITED STATES (USA)',TODATE('2017-03-09', 'YYYY-MM-DD'),TODATE('2017-03-09', 'YYYY-MM-DD'),NULL),
	(8769,'GRYPHON BIKES & CHOPPERS','Motorcycle','1G9340','UNITED STATES (USA)',TODATE('2017-05-08', 'YYYY-MM-DD'),TODATE('2017-05-08', 'YYYY-MM-DD'),NULL),
	(9042,'JIANGMEN ZHONGYU MOTOR (GROUP) CO., LTD.','Motorcycle','LMF','CHINA',TODATE('2017-05-17', 'YYYY-MM-DD'),TODATE('2017-05-17', 'YYYY-MM-DD'),NULL),
	(16100,'JHC NEW ENERGY VEHICLE HONGKONG CO.,LTD','Low Speed Vehicle (LSV)','R1A','CHINA',TODATE('2017-05-23', 'YYYY-MM-DD'),TODATE('2017-05-23', 'YYYY-MM-DD'),NULL),
	(16653,'NANCHANG AIRCRAFT MFG. CO ( HONGDU MACHINERY PLANT)','Motorcycle','LPP','CHINA',TODATE('2017-06-27', 'YYYY-MM-DD'),TODATE('2017-06-27', 'YYYY-MM-DD'),NULL),
	(1879,'HONNOR MARINE LTD','Trailer','SA9112','UNITED KINGDOM (UK)',TODATE('2017-11-03', 'YYYY-MM-DD'),TODATE('2017-11-03', 'YYYY-MM-DD'),NULL),
	(17562,'HONGDU ELECTRIC VEHICLE HONGKONG CO.,LIMITED','Motorcycle','R2L','CHINA',TODATE('2018-01-17', 'YYYY-MM-DD'),TODATE('2018-01-17', 'YYYY-MM-DD'),NULL),
	(9877,'HONGDOU GROUP CHITUMA MOTORCYCLE COMPANY','Motorcycle','LE6','CHINA',TODATE('2018-01-25', 'YYYY-MM-DD'),TODATE('2018-01-25', 'YYYY-MM-DD'),NULL),
	(3847,'MARATHON EQUIPMENT COMPANY (DEL)','Trailer','1M9371','UNITED STATES (USA)',TODATE('2018-03-14', 'YYYY-MM-DD'),TODATE('2018-03-14', 'YYYY-MM-DD'),NULL),
	(17686,'CHONGQING HUANGHE MOTORCYCLE CO.,LTD. ','Motorcycle','LDU','CHINA',TODATE('2018-05-11', 'YYYY-MM-DD'),TODATE('2018-05-11', 'YYYY-MM-DD'),NULL),
	(18570,'CHONGQING LIYANG JIAYU MOTORCYCLE CO., LTD.','Motorcycle','LC4','CHINA',TODATE('2018-08-10', 'YYYY-MM-DD'),TODATE('2018-08-10', 'YYYY-MM-DD'),NULL),
	(20032,'ELYX SMART TECHNOLOGY HOLDINGS (HONGKONG) LIMITED','Motorcycle','R4N','CHINA',TODATE('2020-08-31', 'YYYY-MM-DD'),TODATE('2020-08-31', 'YYYY-MM-DD'),NULL)
) AS SOURCE(
	[Id],
	[Name],
	[VehicleType],
	[WMI],
	[Country],
	[DateAvailableToPublic], 
	[CreatedOn],
	[UpdatedOn]
)
ON TARGET.Id = SOURCE.Id
WHEN MATCHED
THEN UPDATE SET
	TARGET.[Name] = SOURCE.[Name],
	TARGET.[VehicleType] = SOURCE.[VehicleType],
	TARGET.[WMI] = SOURCE.[WMI],
	TARGET.[Country] = SOURCE.[Country],
	TARGET.[DateAvailableToPublic] = SOURCE.[DateAvailableToPublic], 
	TARGET.[CreatedOn] = SOURCE.[CreatedOn],
	TARGET.[UpdatedOn] = SOURCE.[UpdatedOn]
WHEN NOT MATCHED BY TARGET
THEN INSERT(
	[Id],
	[Name]
)
VALUES(
	SOURCE.[Id],
	SOURCE.[Name],
	SOURCE.[VehicleType],
	SOURCE.[WMI],
	SOURCE.[Country],
	SOURCE.[DateAvailableToPublic], 
	SOURCE.[CreatedOn],
	SOURCE.[UpdatedOn]
);

SET IDENTITY_INSERT HondaWMI OFF;

SET NOCOUNT OFF;
GO

GO
PRINT N'Update complete.';


GO
